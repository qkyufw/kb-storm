# AI 功能更新说明

## 概述

kb-storm 现已集成强大的 AI 智能功能，帮助您更高效地进行思维整理和内容创作。目前提供三大核心功能：**扩展思路**、**整理精简**和**导出草稿**，每个功能都支持自定义配置和灵活调用。

## 🚀 功能特性

### 1. 扩展思路 (Expand Ideas)
基于当前视口内的卡片内容，AI 将生成相关的新想法和扩展内容，帮助您突破思维局限，激发更多创意。

**主要特点：**
- 智能分析现有卡片内容
- 生成 10-20 个相关的新想法
- 保持与原始内容的逻辑关联
- 支持创意温度调节（0.1-1.0）

### 2. 整理精简 (Organize & Refine)
AI 将整理和精简当前视口内的卡片内容，去除冗余信息，提炼核心要点，让您的思维导图更加清晰有序。

**主要特点：**
- 合并相似或相关内容
- 去除重复和冗余信息
- 提取核心要点和关键信息
- 生成 3-8 个精简的核心卡片

### 3. 导出草稿 (Export Draft)
基于当前视口内的卡片内容生成结构化的草稿文章，将零散的想法整理成完整的文档。

**主要特点：**
- 分析卡片内容的主题和逻辑关系
- 构建清晰的文章结构
- 支持 Markdown 格式输出
- 提供复制和导出功能

## 📋 使用方法

### 基础使用流程

1. **配置 AI 服务**
   - 点击工具栏中的 "AI配置" 按钮
   - 选择 AI 提供商（OpenAI、DeepSeek、Anthropic 或自定义 API）
       - （！！！**暂时只测试了自定义 API 中的硅基流动**！！！）
   - 输入 API 密钥和相关配置
   - 测试连接确保配置正确
   
2. **使用 AI 功能**
   - 在画布上创建一些卡片内容
   - 调整视口范围，确保要处理的卡片在当前视图中
   - 点击工具栏中的 "AI智能功能" 下拉菜单
   - 选择所需的功能：扩展思路、整理精简或导出草稿

### 详细操作指南

#### 扩展思路
1. 确保视口内有需要扩展的卡片内容
2. 点击 "扩展思路" 按钮
3. 如果配置了"执行前打开配置"，会弹出配置对话框：
   - 可以修改任务描述来指导 AI 的扩展方向
   - 调整创意温度（数值越高越有创意）
   - 点击 "立即执行" 或 "保存" 后执行
4. AI 将在视口周围生成新的扩展卡片

#### 整理精简
1. 选择需要整理的卡片区域
2. 点击 "整理精简" 按钮
3. 在配置对话框中可以：
   - 自定义整理要求和重点
   - 设置保守程度（温度设置）
4. AI 将删除原有卡片并生成精简后的新卡片

#### 导出草稿
1. 确保视口内包含要导出的内容
2. 点击 "导出草稿" 按钮
3. 在草稿导出对话框中：
   - 可以修改生成描述
   - 调整创意温度
   - 选择 "生成草稿" 或 "逻辑草稿"
4. 生成完成后可以：
   - 重新生成内容
   - 复制到剪贴板
   - 导出为 Markdown 文件

## ⚙️ 高级配置

### 功能配置选项

每个 AI 功能都支持以下配置：

- **任务描述**：自定义 AI 执行任务时的指令
- **创意温度**：控制 AI 输出的创意程度（0.1-1.0）
- **最大令牌数**：限制 AI 响应的长度
- **执行前配置**：是否在每次执行前打开配置对话框

### 默认配置参数

| 功能 | 默认温度 | 最大令牌 | 默认描述 |
|------|----------|----------|----------|
| 扩展思路 | 0.8 | 3000 | 基于现有内容进行创意扩展，生成相关的新想法和子主题 |
| 整理精简 | 0.3 | 2000 | 对内容进行整理和精简，提取核心要点 |
| 导出草稿 | 0.7 | 4000 | 基于卡片内容生成一份结构化的草稿文章 |

## 🔄 新增功能（开发中）

### 逻辑整理 (Logic Organization)
**状态：开发完善中**

基于思维导图的连接关系进行逻辑整理，优化卡片之间的结构和连接关系。

**计划特性：**
- 分析卡片间的逻辑关系
- 优化连接线的布局
- 重新组织思维导图结构
- 导出优化后的 Mermaid 图表

### 逻辑草稿 (Logic Draft)
**状态：开发完善中**

基于思维导图的逻辑结构生成更加结构化的草稿文章。

**计划特性：**
- 考虑卡片间的连接关系
- 按照逻辑层次生成文章
- 保持思维导图的层次结构
- 生成更有逻辑性的文档

## 💡 使用技巧

1. **视口范围控制**：AI 功能只处理当前视口范围内的卡片，通过缩放和平移来控制处理范围

2. **分批处理**：对于大量卡片，建议分区域使用 AI 功能，效果更好

3. **自定义描述**：根据具体需求修改任务描述，可以获得更符合期望的结果

4. **温度调节**：
   - 扩展思路：使用较高温度（0.6-0.9）获得更多创意，使用较低温度获得相关度更高的创意
   - 整理精简：使用较低温度（0.2-0.4）保持逻辑性
   - 导出草稿：使用中等温度（0.5-0.7）平衡创意和逻辑

5. **迭代优化**：可以多次使用同一功能，逐步完善内容

## 🔧 故障排除

### 常见问题

1. **AI 服务未配置**
   - 确保已正确配置 AI 提供商和 API 密钥
   - 使用"测试连接"功能验证配置

2. **视口内无内容**
   - 确保当前视口范围内有卡片
   - 调整视图范围包含需要处理的卡片

3. **生成结果不理想**
   - 尝试修改任务描述，提供更具体的指导
   - 调整温度设置
   - 重新生成内容

4. **API 调用失败**
   - 检查网络连接
   - 验证 API 密钥是否有效
   - 确认 API 配额是否充足

## 📞 技术支持

如果您在使用 AI 功能时遇到问题，请：

1. 查看浏览器控制台的错误信息
2. 确认 AI 服务配置是否正确
3. 尝试重新配置 AI 服务
4. 在项目 GitHub 页面提交 Issue

---

**注意**：逻辑整理和逻辑草稿功能目前仍在完善中，可能存在一些不稳定的情况。正在持续优化这些功能，敬请期待后续更新。
